<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mirrorcle - AI ë¶„ì„ ë„êµ¬</title>
  
  <link rel="apple-touch-icon" sizes="512x512" href="icon-512x512.png" />
  <link rel="apple-touch-icon" sizes="128x128" href="icon-128x128.png" /> 
  <!-- PWA ë©”íƒ€ íƒœê·¸ -->
  <meta name="theme-color" content="#667eea">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Mirrorcle">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="application-name" content="Mirrorcle">
  
  <!-- PWA ë§¤ë‹ˆí˜ìŠ¤íŠ¸ -->
  <link rel="manifest" href="manifest.json">
  
  <!-- íŒŒë¹„ì½˜ ë° ì•„ì´ì½˜ -->
  <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192x192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="icons/icon-512x512.png">
  <link rel="apple-touch-icon" href="icons/icon-192x192.png">
  
  <style>
    body {
      text-align: center;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #333;
    }
    
    .container {
      max-width: 100%;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      backdrop-filter: blur(10px);
    }
    
    h1 {
      color: #333;
      margin-bottom: 30px;
      font-size: 2.5em;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
    }
    
    .mode-selection {
      margin: 30px auto;
      max-width: 600px;
      background: white;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }
    
    .mode-selection h2 {
      color: #333;
      margin-bottom: 20px;
      font-size: 1.5em;
    }
    
    .mode-buttons {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .mode-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      color: white;
      padding: 20px 30px;
      border-radius: 12px;
      cursor: pointer;
      font-size: 16px;
      min-width: 200px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      touch-action: manipulation;
    }
    
    .mode-btn:hover, .mode-btn:active {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.3);
    }
    
    .mode-btn.emotion {
      background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
    }
    
    .mode-btn.skin {
      background: linear-gradient(135deg, #48cae4 0%, #023e8a 100%);
    }
    
    .mode-description {
      margin-top: 10px;
      font-size: 14px;
      color: #666;
      line-height: 1.4;
    }
    
    /* í”¼ë¶€ ìƒíƒœ ì„ íƒ í™”ë©´ */
    .skin-analysis {
      margin: 30px auto;
      max-width: 800px;
      background: white;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      display: none;
    }
    
    .skin-question {
      margin-bottom: 30px;
      text-align: left;
    }
    
    .skin-question h3 {
      color: #333;
      margin-bottom: 15px;
      font-size: 1.2em;
      text-align: center;
    }
    
    .skin-options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .skin-option {
      background: #f8f9fa;
      border: 2px solid #e9ecef;
      border-radius: 10px;
      padding: 15px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
    }
    
    .skin-option:hover {
      border-color: #48cae4;
      background: #e3f2fd;
    }
    
    .skin-option.selected {
      border-color: #48cae4;
      background: #e3f2fd;
      box-shadow: 0 2px 8px rgba(72, 202, 228, 0.3);
    }
    
    .skin-option-icon {
      font-size: 24px;
      margin-bottom: 8px;
    }
    
    .skin-option-title {
      font-weight: bold;
      margin-bottom: 5px;
      color: #333;
    }
    
    .skin-option-desc {
      font-size: 12px;
      color: #666;
      line-height: 1.3;
    }
    
    .analyze-skin-btn {
      background: linear-gradient(135deg, #48cae4 0%, #023e8a 100%);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 10px;
      font-size: 16px;
      cursor: pointer;
      margin-top: 20px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }
    
    .analyze-skin-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    }
    
    .analyze-skin-btn:disabled {
      background: #cccccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    /* í™”ì¥í’ˆ ì¶”ì²œ */
    .cosmetics-recommendation {
      margin: 30px auto;
      max-width: 1000px;
      background: white;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      display: none;
    }
    
    .cosmetics-title {
      font-size: 24px;
      margin-bottom: 20px;
      color: #333;
      text-align: center;
    }
    
    .cosmetics-subtitle {
      font-size: 16px;
      color: #666;
      margin-bottom: 30px;
      text-align: center;
    }
    
    .cosmetics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    
    .cosmetic-item {
      background: #f8f9fa;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: transform 0.2s ease;
    }
    
    .cosmetic-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    
    .cosmetic-category {
      font-size: 18px;
      font-weight: bold;
      color: #333;
      margin-bottom: 15px;
      text-align: center;
      padding: 8px;
      background: linear-gradient(135deg, #48cae4, #023e8a);
      color: white;
      border-radius: 8px;
    }
    
    .cosmetic-product {
      margin-bottom: 15px;
      padding: 10px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    .product-name {
      font-weight: bold;
      color: #333;
      margin-bottom: 5px;
    }
    
    .product-desc {
      font-size: 14px;
      color: #666;
      margin-bottom: 10px;
      line-height: 1.4;
    }
    
    .product-links {
      display: flex;
      gap: 10px;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .product-link {
      background: #ff6b35;
      color: white;
      text-decoration: none;
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 12px;
      transition: background-color 0.3s;
      display: inline-block;
    }
    
    .product-link.coupang {
      background: #ff6b35;
    }
    
    .product-link.oliveyoung {
      background: #00c73c;
    }
    
    .product-link:hover {
      opacity: 0.8;
    }
    
    #webcam-container {
      margin: 20px auto;
      display: inline-block;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      overflow: hidden;
      background: white;
      max-width: 100%;
    }
    
    canvas {
      border-radius: 12px;
      display: block;
      max-width: 100%;
      height: auto;
    }
    
    #status {
      font-size: 18px;
      margin: 20px;
      color: #333;
      min-height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: white;
      border-radius: 8px;
      padding: 15px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      line-height: 1.4;
    }
    
    #predictions {
      margin: 20px auto;
      max-width: 400px;
      background: white;
      border-radius: 8px;
      padding: 15px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    #music-recommendation {
      margin: 20px auto;
      max-width: 600px;
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      display: none;
    }
    
    .music-title {
      font-size: 20px;
      margin-bottom: 15px;
      color: #333;
      text-align: center;
    }
    
    .music-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }
    
    .music-item {
      background: #f9f9f9;
      border-radius: 8px;
      padding: 10px;
      text-align: center;
      transition: transform 0.2s ease;
      cursor: pointer;
      touch-action: manipulation;
    }
    
    .music-item:hover, .music-item:active {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    
    .music-thumbnail {
      width: 100%;
      max-width: 240px;
      height: 135px;
      object-fit: cover;
      border-radius: 6px;
      margin-bottom: 8px;
    }
    
    .music-info {
      text-align: left;
    }
    
    .music-title-text {
      font-size: 14px;
      font-weight: bold;
      color: #333;
      margin-bottom: 4px;
      line-height: 1.3;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    
    .music-channel {
      font-size: 12px;
      color: #666;
      margin-bottom: 8px;
    }
    
    .play-button {
      background: #ff0000;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 20px;
      cursor: pointer;
      font-size: 12px;
      transition: background-color 0.3s;
      touch-action: manipulation;
    }
    
    .play-button:hover, .play-button:active {
      background: #cc0000;
    }
    
    .loading-music {
      text-align: center;
      color: #666;
      font-style: italic;
    }
    
    .prediction-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 8px 0;
      padding: 8px;
      border-radius: 6px;
      background: #f9f9f9;
    }
    
    .prediction-bar {
      width: 100px;
      height: 20px;
      background: #e0e0e0;
      border-radius: 10px;
      overflow: hidden;
    }
    
    .prediction-fill {
      height: 100%;
      background: linear-gradient(90deg, #ff6b6b, #4ecdc4);
      transition: width 0.3s ease;
    }
    
    button {
      background: #4CAF50;
      border: none;
      color: white;
      padding: 12px 24px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      margin: 10px;
      cursor: pointer;
      border-radius: 8px;
      transition: all 0.3s;
      touch-action: manipulation;
      font-family: inherit;
    }
    
    button:hover, button:active {
      background: #45a049;
      transform: translateY(-1px);
    }
    
    button:disabled {
      background: #cccccc;
      cursor: not-allowed;
      transform: none;
    }
    
    .success {
      color: #4CAF50;
      font-weight: bold;
    }
    
    .error {
      color: #f44336;
      font-weight: bold;
    }
    
    .warning {
      color: #ff9800;
      font-weight: bold;
    }
    
    .back-btn {
      background: #6c757d;
      margin-bottom: 20px;
    }
    
    .back-btn:hover, .back-btn:active {
      background: #5a6268;
    }
    
    .main-content {
      display: none;
    }
    
    .mode-title {
      font-size: 24px;
      margin-bottom: 20px;
      color: #333;
    }
    
    /* PWA ì„¤ì¹˜ ì•ˆë‚´ */
    .install-prompt {
      background: linear-gradient(135deg, #4CAF50, #45a049);
      color: white;
      padding: 15px;
      border-radius: 10px;
      margin: 20px 0;
      display: none;
      animation: slideIn 0.5s ease-out;
    }
    
    .install-prompt.show {
      display: block;
    }
    
    .install-btn {
      background: rgba(255,255,255,0.2);
      border: 1px solid rgba(255,255,255,0.3);
      color: white;
      margin: 5px;
      padding: 8px 16px;
      font-size: 14px;
    }
    
    .install-btn:hover, .install-btn:active {
      background: rgba(255,255,255,0.3);
    }
    
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    /* ëª¨ë°”ì¼ ìµœì í™” */
    @media (max-width: 768px) {
      body {
        padding: 10px;
      }
      
      .container {
        padding: 15px;
        border-radius: 15px;
      }
      
      h1 {
        font-size: 2em;
        margin-bottom: 20px;
      }
      
      .mode-selection, .skin-analysis, .cosmetics-recommendation {
        padding: 20px;
      }
      
      .mode-btn {
        min-width: 150px;
        padding: 15px 20px;
        font-size: 14px;
      }
      
      .mode-buttons {
        flex-direction: column;
        align-items: center;
      }
      
      .skin-options {
        grid-template-columns: 1fr;
      }
      
      .cosmetics-grid {
        grid-template-columns: 1fr;
      }
      
      .music-grid {
        grid-template-columns: 1fr;
      }
      
      #status {
        font-size: 16px;
        padding: 12px;
        margin: 15px;
      }
      
      canvas {
        max-width: 100%;
        height: auto;
      }
    }
    
    /* ì‘ì€ í™”ë©´ ëŒ€ì‘ */
    @media (max-width: 480px) {
      .mode-btn {
        min-width: 100%;
        margin-bottom: 10px;
      }
      
      .cosmetics-grid, .music-grid {
        gap: 10px;
      }
      
      .cosmetic-item, .music-item {
        padding: 15px;
      }
      
      .product-links {
        flex-direction: column;
        align-items: center;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- PWA ì„¤ì¹˜ ì•ˆë‚´ -->
    <div id="installPrompt" class="install-prompt">
      ğŸ“± Mirrorcleì„ ì•±ì²˜ëŸ¼ ì‚¬ìš©í•˜ì„¸ìš”!
      <br>
      <button id="installBtn" class="install-btn">í™ˆ í™”ë©´ì— ì¶”ê°€</button>
      <button onclick="hideInstallPrompt()" class="install-btn">ë‚˜ì¤‘ì—</button>
    </div>
    
    <h1>ğŸª Mirrorcle</h1>
    
    <!-- ëª¨ë“œ ì„ íƒ í™”ë©´ -->
    <div id="mode-selection" class="mode-selection">
      <h2>ë¶„ì„ ëª¨ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</h2>
      <div class="mode-buttons">
        <div>
          <button class="mode-btn emotion" onclick="selectMode('emotion')">
            ğŸ˜Š í‘œì • ê°ì • ì¸ì‹
          </button>
          <div class="mode-description">
            ì¹´ë©”ë¼ë¡œ í‘œì •ì„ ì¸ì‹í•˜ì—¬<br>ê°ì • ìƒíƒœë¥¼ ë¶„ì„í•©ë‹ˆë‹¤
          </div>
        </div>
        <div>
          <button class="mode-btn skin" onclick="selectMode('skin')">
            âœ¨ í”¼ë¶€ ìƒíƒœ ë¶„ì„
          </button>
          <div class="mode-description">
            ì–¼êµ´ì„ ì´¬ì˜í•˜ì—¬<br>í”¼ë¶€ ìƒíƒœë¥¼ ë¶„ì„í•©ë‹ˆë‹¤
          </div>
        </div>
      </div>
    </div>
    
    <!-- í”¼ë¶€ ìƒíƒœ ë¶„ì„ í™”ë©´ -->
    <div id="skin-analysis" class="skin-analysis">
      <button class="back-btn" onclick="goBack()">â† ëª¨ë“œ ì„ íƒìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
      
      <h2>ğŸ” í”¼ë¶€ ìƒíƒœ ë¶„ì„</h2>
      
      <div class="skin-question">
        <h3>1. íŠ¸ëŸ¬ë¸” ìƒíƒœë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</h3>
        <div class="skin-options" id="trouble-options">
          <div class="skin-option" data-value="none">
            <div class="skin-option-icon">âœ¨</div>
            <div class="skin-option-title">íŠ¸ëŸ¬ë¸” ì—†ìŒ</div>
            <div class="skin-option-desc">ê¹¨ë—í•œ í”¼ë¶€ ìƒíƒœ</div>
          </div>
          <div class="skin-option" data-value="light">
            <div class="skin-option-icon">ğŸ”¸</div>
            <div class="skin-option-title">ê°€ë²¼ìš´ íŠ¸ëŸ¬ë¸”</div>
            <div class="skin-option-desc">ê°„í—ì ì¸ ë¾°ë£¨ì§€ë‚˜ ëª¨ê³µ</div>
          </div>
          <div class="skin-option" data-value="moderate">
            <div class="skin-option-icon">ğŸ”¶</div>
            <div class="skin-option-title">ë³´í†µ íŠ¸ëŸ¬ë¸”</div>
            <div class="skin-option-desc">ì—¬ë“œë¦„ì´ë‚˜ ì—¼ì¦ ë¶€ìœ„</div>
          </div>
          <div class="skin-option" data-value="severe">
            <div class="skin-option-icon">ğŸ”´</div>
            <div class="skin-option-title">ì‹¬í•œ íŠ¸ëŸ¬ë¸”</div>
            <div class="skin-option-desc">í™”ë†ì„± ì—¬ë“œë¦„ì´ë‚˜ í‰í„°</div>
          </div>
        </div>
      </div>
      
      <div class="skin-question">
        <h3>2. í™”ë†ì„± ì—¬ë“œë¦„ì´ ìˆìœ¼ì‹ ê°€ìš”?</h3>
        <div class="skin-options" id="acne-options">
          <div class="skin-option" data-value="no">
            <div class="skin-option-icon">âœ…</div>
            <div class="skin-option-title">ì—†ìŒ</div>
            <div class="skin-option-desc">í™”ë†ì„± ì—¬ë“œë¦„ì´ ì—†ìŒ</div>
          </div>
          <div class="skin-option" data-value="yes">
            <div class="skin-option-icon">âš ï¸</div>
            <div class="skin-option-title">ìˆìŒ</div>
            <div class="skin-option-desc">í™”ë†ì„± ì—¬ë“œë¦„ì´ ìˆìŒ</div>
          </div>
        </div>
      </div>
      
      <div class="skin-question">
        <h3>3. í”¼ë¶€ íƒ€ì…ì„ ì„ íƒí•´ì£¼ì„¸ìš”</h3>
        <div class="skin-options" id="skin-type-options">
          <div class="skin-option" data-value="dry">
            <div class="skin-option-icon">ğŸœï¸</div>
            <div class="skin-option-title">ê±´ì„±</div>
            <div class="skin-option-desc">ê±´ì¡°í•˜ê³  ë‹¹ê¸°ëŠ” ëŠë‚Œ</div>
          </div>
          <div class="skin-option" data-value="oily">
            <div class="skin-option-icon">ğŸ’§</div>
            <div class="skin-option-title">ì§€ì„±</div>
            <div class="skin-option-desc">ê¸°ë¦„ì§€ê³  ë²ˆë“¤ê±°ë¦¼</div>
          </div>
          <div class="skin-option" data-value="combination">
            <div class="skin-option-icon">ğŸŒ“</div>
            <div class="skin-option-title">ë³µí•©ì„±</div>
            <div class="skin-option-desc">Tì¡´ì€ ì§€ì„±, ë³¼ì€ ê±´ì„±</div>
          </div>
          <div class="skin-option" data-value="sensitive">
            <div class="skin-option-icon">ğŸŒ¸</div>
            <div class="skin-option-title">ë¯¼ê°ì„±</div>
            <div class="skin-option-desc">ìê·¹ì— ë¯¼ê°í•˜ê³  ì‰½ê²Œ ë¹¨ê°›ê²Œ ë¨</div>
          </div>
        </div>
      </div>
      
      <button id="analyze-btn" class="analyze-skin-btn" onclick="analyzeSkin()" disabled>
        í”¼ë¶€ ë¶„ì„ ë° í™”ì¥í’ˆ ì¶”ì²œë°›ê¸°
      </button>
    </div>
    
    <!-- í™”ì¥í’ˆ ì¶”ì²œ í™”ë©´ -->
    <div id="cosmetics-recommendation" class="cosmetics-recommendation">
      <button class="back-btn" onclick="goBackToSkinAnalysis()">â† í”¼ë¶€ ë¶„ì„ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
      
      <div class="cosmetics-title">âœ¨ ë§ì¶¤ í™”ì¥í’ˆ ì¶”ì²œ</div>
      <div class="cosmetics-subtitle" id="recommendation-subtitle"></div>
      
      <div class="cosmetics-grid" id="cosmetics-grid">
        <!-- í™”ì¥í’ˆ ì¶”ì²œ ë‚´ìš©ì´ ì—¬ê¸°ì— ë“¤ì–´ê°‘ë‹ˆë‹¤ -->
      </div>
    </div>
    
    <!-- ë©”ì¸ ì½˜í…ì¸  (ê°ì • ì¸ì‹ìš©) -->
    <div id="main-content" class="main-content">
      <button class="back-btn" onclick="goBack()">â† ëª¨ë“œ ì„ íƒìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
      
      <div id="mode-title" class="mode-title"></div>
      
      <div id="webcam-container"></div>
      
      <div id="status">ì´ˆê¸°í™” ì¤‘...</div>
      
      <div id="predictions" style="display: none;">
        <h3>ì‹¤ì‹œê°„ ì˜ˆì¸¡ ê²°ê³¼</h3>
        <div id="prediction-list"></div>
      </div>
      
      <div id="music-recommendation">
        <div class="music-title">ğŸµ ë‹¹ì‹ ì˜ ê¸°ë¶„ì— ë§ëŠ” ìŒì•… ì¶”ì²œ</div>
        <div id="music-content"></div>
      </div>
      
      <div id="controls">
        <button id="startBtn" onclick="startDetection()" disabled>ë¶„ì„ ì‹œì‘</button>
        <button id="restartBtn" onclick="restart()" style="display: none;">ë‹¤ì‹œ ì‹œë„</button>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/tensorflow/3.18.0/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>
  
  <script>
    // ì „ì—­ ë³€ìˆ˜
    let currentMode = '';
    let model, webcam, maxPredictions;
    let isDetecting = false;
    let skinAnalysisData = {
      trouble: '',
      acne: '',
      skinType: ''
    };
    
    // í™”ì¥í’ˆ ë°ì´í„°ë² ì´ìŠ¤
    const cosmeticsDatabase = {
      dry: {
        trouble_none: {
          cleanser: {
            name: "ì„¸íƒ€í•„ ì  í‹€ ìŠ¤í‚¨ í´ë Œì €",
            desc: "ê±´ì„± í”¼ë¶€ë¥¼ ìœ„í•œ ìˆœí•œ í´ë Œì§•",
            coupang: "https://www.coupang.com/vp/products/1234567890",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000000123456"
          },
          moisturizer: {
            name: "ì„¸ë¼ë²  ëª¨ì´ìŠ¤ì¶°ë¼ì´ì§• í¬ë¦¼",
            desc: "ì„¸ë¼ë§ˆì´ë“œ í•¨ìœ ë¡œ ê¹Šì€ ë³´ìŠµ",
            coupang: "https://www.coupang.com/vp/products/2345678901",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000000234567"
          },
          serum: {
            name: "íˆì•Œë£¨ë¡ ì‚° ì„¸ëŸ¼",
            desc: "ìˆ˜ë¶„ ê³µê¸‰ì„ ìœ„í•œ íˆì•Œë£¨ë¡ ì‚°",
            coupang: "https://www.coupang.com/vp/products/3456789012",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000000345678"
          }
        },
        trouble_light: {
          cleanser: {
            name: "ë¼ë¡œìŠˆí¬ì œ í†¨ëŸ¬ë¦¬ì–¸ í´ë Œì €",
            desc: "ë¯¼ê°í•œ ê±´ì„± í”¼ë¶€ë¥¼ ìœ„í•œ ìˆœí•œ í´ë Œì§•",
            coupang: "https://www.coupang.com/vp/products/4567890123",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000000456789"
          },
          moisturizer: {
            name: "ì•„ë²¤ëŠ ìµìŠ¤íŠ¸ë¦¼ ì—ë©€ì „",
            desc: "ê±´ì¡°í•˜ê³  ë¯¼ê°í•œ í”¼ë¶€ë¥¼ ìœ„í•œ ì§„ì • ë³´ìŠµ",
            coupang: "https://www.coupang.com/vp/products/5678901234",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000000567890"
          },
          treatment: {
            name: "íŒí† í…ì‚° ì§„ì • í¬ë¦¼",
            desc: "ì—¼ì¦ ì§„ì •ê³¼ ë³´ìŠµì„ ë™ì‹œì—",
            coupang: "https://www.coupang.com/vp/products/6789012345",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000000678901"
          }
        },
        trouble_moderate: {
          cleanser: {
            name: "ìœ ì„¸ë¦° ë”ë§ˆí† í´ë¦° í´ë Œì €",
            desc: "ê±´ì„± íŠ¸ëŸ¬ë¸” í”¼ë¶€ë¥¼ ìœ„í•œ ì €ìê·¹ í´ë Œì§•",
            coupang: "https://www.coupang.com/vp/products/7890123456",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000000789012"
          },
          treatment: {
            name: "ë‹ˆì•„ì‹ ì•„ë§ˆì´ë“œ ì„¸ëŸ¼",
            desc: "ëª¨ê³µ ì¼€ì–´ì™€ í”¼ì§€ ì¡°ì ˆ",
            coupang: "https://www.coupang.com/vp/products/8901234567",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000000890123"
          },
          moisturizer: {
            name: "ì„¸ë¼ë²  PM í˜ì´ì…œ ëª¨ì´ìŠ¤ì¶°ë¼ì´ì €",
            desc: "ë°¤ì‚¬ìš© ì§‘ì¤‘ ë³´ìŠµ ì¼€ì–´",
            coupang: "https://www.coupang.com/vp/products/9012345678",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000000901234"
          }
        }
      },
      oily: {
        trouble_none: {
          cleanser: {
            name: "í´ë¼ì´ˆì´ìŠ¤ CALM í´ë Œì €",
            desc: "ì§€ì„± í”¼ë¶€ë¥¼ ìœ„í•œ ë°¸ëŸ°ì‹± í´ë Œì§•",
            coupang: "https://www.coupang.com/vp/products/1111111111",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000001111111"
          },
          toner: {
            name: "ì‚´ë¦¬ì‹¤ì‚° í† ë„ˆ",
            desc: "ëª¨ê³µ ì¼€ì–´ì™€ í”¼ì§€ ì¡°ì ˆ",
            coupang: "https://www.coupang.com/vp/products/2222222222",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000002222222"
          },
          moisturizer: {
            name: "íˆì•Œë£¨ë¡ ì‚° ì ¤ í¬ë¦¼",
            desc: "ê°€ë²¼ìš´ ìˆ˜ë¶„ ê³µê¸‰",
            coupang: "https://www.coupang.com/vp/products/3333333333",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000003333333"
          }
        },
        trouble_light: {
          cleanser: {
            name: "CeraVe í¼ í´ë Œì €",
            desc: "ì§€ì„± í”¼ë¶€ë¥¼ ìœ„í•œ ë”¥ í´ë Œì§•",
            coupang: "https://www.coupang.com/vp/products/4444444444",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000004444444"
          },
          treatment: {
            name: "BHA ì—‘ìŠ¤í´ë¦¬ì—ì´íŒ… ì„¸ëŸ¼",
            desc: "ê°ì§ˆ ì œê±°ì™€ ëª¨ê³µ ì¼€ì–´",
            coupang: "https://www.coupang.com/vp/products/5555555555",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000005555555"
          },
          moisturizer: {
            name: "ë‹ˆì•„ì‹ ì•„ë§ˆì´ë“œ ëª¨ì´ìŠ¤ì¶°ë¼ì´ì €",
            desc: "ìœ ë¶„ ì¡°ì ˆê³¼ ì§„ì • íš¨ê³¼",
            coupang: "https://www.coupang.com/vp/products/6666666666",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000006666666"
          }
        },
        trouble_moderate: {
          cleanser: {
            name: "ë²¤ì¡°ì¼ í¼ì˜¥ì‚¬ì´ë“œ í´ë Œì €",
            desc: "ì—¬ë“œë¦„ ê·  ì œê±°ì™€ ë”¥ í´ë Œì§•",
            coupang: "https://www.coupang.com/vp/products/7777777777",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000007777777"
          },
          treatment: {
            name: "ë ˆí‹°ë†€ ì„¸ëŸ¼",
            desc: "ì—¬ë“œë¦„ ê°œì„ ê³¼ í”¼ë¶€ ì¬ìƒ",
            coupang: "https://www.coupang.com/vp/products/8888888888",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000008888888"
          },
          spot_treatment: {
            name: "ì‚´ë¦¬ì‹¤ì‚° ìŠ¤íŒŸ íŠ¸ë¦¬íŠ¸ë¨¼íŠ¸",
            desc: "ì§‘ì¤‘ ì—¬ë“œë¦„ ì¼€ì–´",
            coupang: "https://www.coupang.com/vp/products/9999999999",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000009999999"
          }
        }
      },
      combination: {
        trouble_none: {
          cleanser: {
            name: "ë‰´íŠ¸ë¡œì§€ë‚˜ ìš¸íŠ¸ë¼ ì  í‹€ í´ë Œì €",
            desc: "ë³µí•©ì„± í”¼ë¶€ë¥¼ ìœ„í•œ ë°¸ëŸ°ì‹± í´ë Œì§•",
            coupang: "https://www.coupang.com/vp/products/1010101010",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000001010101"
          },
          toner: {
            name: "í•˜ì´ë“œë ˆì´íŒ… í† ë„ˆ",
            desc: "ìˆ˜ë¶„ ê³µê¸‰ê³¼ ìœ ë¶„ ë°¸ëŸ°ì‹±",
            coupang: "https://www.coupang.com/vp/products/2020202020",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000002020202"
          },
          moisturizer: {
            name: "ë“€ì–¼ ì¡´ ëª¨ì´ìŠ¤ì¶°ë¼ì´ì €",
            desc: "Tì¡´ê³¼ Uì¡´ ë§ì¶¤ ì¼€ì–´",
            coupang: "https://www.coupang.com/vp/products/3030303030",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000003030303"
          }
        },
        trouble_light: {
          cleanser: {
            name: "í´ë¼ì´ˆì´ìŠ¤ CLEAR í´ë Œì €",
            desc: "ë³µí•©ì„± íŠ¸ëŸ¬ë¸” í”¼ë¶€ë¥¼ ìœ„í•œ í´ë Œì§•",
            coupang: "https://www.coupang.com/vp/products/4040404040",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000004040404"
          },
          treatment: {
            name: "AHA/BHA ë“€ì–¼ ì„¸ëŸ¼",
            desc: "Tì¡´ ê°ì§ˆì¼€ì–´ì™€ Uì¡´ ë³´ìŠµ",
            coupang: "https://www.coupang.com/vp/products/5050505050",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000005050505"
          },
          moisturizer: {
            name: "ì„¸ë°”ë©”ë“œ í˜ì´ìŠ¤ ì¼€ì–´ ì ¤",
            desc: "pH ë°¸ëŸ°ì‹±ê³¼ ìˆ˜ë¶„ ê³µê¸‰",
            coupang: "https://www.coupang.com/vp/products/6060606060",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000006060606"
          }
        }
      },
      sensitive: {
        trouble_none: {
          cleanser: {
            name: "ë°”ë‹ˆí¬ë¦¼ ì  í‹€ í´ë Œì €",
            desc: "ê·¹ë¯¼ê°ì„± í”¼ë¶€ë¥¼ ìœ„í•œ ìˆœí•œ í´ë Œì§•",
            coupang: "https://www.coupang.com/vp/products/1212121212",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000001212121"
          },
          moisturizer: {
            name: "ì„¼í…”ë¼ ì•„ì‹œì•„í‹°ì¹´ í¬ë¦¼",
            desc: "ì§„ì • íš¨ê³¼ê°€ ë›°ì–´ë‚œ ë³´ìŠµ í¬ë¦¼",
            coupang: "https://www.coupang.com/vp/products/2323232323",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000002323232"
          },
          sunscreen: {
            name: "ë¬´ê¸°ìì°¨ ì„ í¬ë¦¼",
            desc: "ë¯¼ê°í•œ í”¼ë¶€ë¥¼ ìœ„í•œ ë¬¼ë¦¬ì  ì°¨ë‹¨ì œ",
            coupang: "https://www.coupang.com/vp/products/3434343434",
            oliveyoung: "https://www.oliveyoung.co.kr/store/goods/getGoodsDetail.do?goodsNo=A000003434343"
          }
        }
      }
    };

    // PWA ê´€ë ¨ í•¨ìˆ˜ë“¤
    let deferredPrompt;
    
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      showInstallPrompt();
    });

    function showInstallPrompt() {
      document.getElementById('installPrompt').classList.add('show');
    }

    function hideInstallPrompt() {
      document.getElementById('installPrompt').classList.remove('show');
    }

    document.getElementById('installBtn').addEventListener('click', async () => {
      if (deferredPrompt) {
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        deferredPrompt = null;
        hideInstallPrompt();
      }
    });

    // ëª¨ë“œ ì„ íƒ í•¨ìˆ˜
    function selectMode(mode) {
      currentMode = mode;
      
      if (mode === 'emotion') {
        document.getElementById('mode-selection').style.display = 'none';
        document.getElementById('main-content').style.display = 'block';
        document.getElementById('mode-title').textContent = 'ğŸ˜Š í‘œì • ê°ì • ì¸ì‹';
        initEmotionDetection();
      } else if (mode === 'skin') {
        document.getElementById('mode-selection').style.display = 'none';
        document.getElementById('skin-analysis').style.display = 'block';
        initSkinAnalysis();
      }
    }

    // ë’¤ë¡œê°€ê¸° í•¨ìˆ˜
    function goBack() {
      document.getElementById('mode-selection').style.display = 'block';
      document.getElementById('main-content').style.display = 'none';
      document.getElementById('skin-analysis').style.display = 'none';
      document.getElementById('cosmetics-recommendation').style.display = 'none';
      stopWebcam();
    }

    function goBackToSkinAnalysis() {
      document.getElementById('skin-analysis').style.display = 'block';
      document.getElementById('cosmetics-recommendation').style.display = 'none';
    }

    // í”¼ë¶€ ë¶„ì„ ì´ˆê¸°í™”
    function initSkinAnalysis() {
      // ì˜µì…˜ ì„ íƒ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
      addSkinOptionListeners();
    }

    function addSkinOptionListeners() {
      // íŠ¸ëŸ¬ë¸” ì˜µì…˜
      document.querySelectorAll('#trouble-options .skin-option').forEach(option => {
        option.addEventListener('click', () => {
          selectSkinOption('trouble', option);
        });
      });

      // í™”ë†ì„± ì—¬ë“œë¦„ ì˜µì…˜
      document.querySelectorAll('#acne-options .skin-option').forEach(option => {
        option.addEventListener('click', () => {
          selectSkinOption('acne', option);
        });
      });

      // í”¼ë¶€ íƒ€ì… ì˜µì…˜
      document.querySelectorAll('#skin-type-options .skin-option').forEach(option => {
        option.addEventListener('click', () => {
          selectSkinOption('skinType', option);
        });
      });
    }

    function selectSkinOption(category, selectedOption) {
      // ê°™ì€ ì¹´í…Œê³ ë¦¬ì˜ ë‹¤ë¥¸ ì˜µì…˜ë“¤ ì„ íƒ í•´ì œ
      const categoryOptions = selectedOption.parentElement.querySelectorAll('.skin-option');
      categoryOptions.forEach(option => option.classList.remove('selected'));
      
      // ì„ íƒëœ ì˜µì…˜ í™œì„±í™”
      selectedOption.classList.add('selected');
      
      // ë°ì´í„° ì €ì¥
      skinAnalysisData[category] = selectedOption.dataset.value;
      
      // ëª¨ë“  ì˜µì…˜ì´ ì„ íƒë˜ì—ˆëŠ”ì§€ í™•ì¸
      checkAnalysisReady();
    }

    function checkAnalysisReady() {
      const analyzeBtn = document.getElementById('analyze-btn');
      if (skinAnalysisData.trouble && skinAnalysisData.acne && skinAnalysisData.skinType) {
        analyzeBtn.disabled = false;
      } else {
        analyzeBtn.disabled = true;
      }
    }

    // í”¼ë¶€ ë¶„ì„ ì‹¤í–‰
    function analyzeSkin() {
      const { trouble, acne, skinType } = skinAnalysisData;
      
      // í™”ë†ì„± ì—¬ë“œë¦„ì´ ìˆëŠ” ê²½ìš° íŠ¸ëŸ¬ë¸” ë ˆë²¨ ì¡°ì •
      let troubleLevel = trouble;
      if (acne === 'yes' && trouble !== 'severe') {
        troubleLevel = 'moderate';
      }
      
      const key = `trouble_${troubleLevel}`;
      const recommendations = cosmeticsDatabase[skinType] && cosmeticsDatabase[skinType][key];
      
      if (recommendations) {
        showCosmeticsRecommendation(recommendations, skinType, troubleLevel, acne === 'yes');
      } else {
        // ê¸°ë³¸ ì¶”ì²œ
        showBasicRecommendation(skinType);
      }
    }

    function showCosmeticsRecommendation(recommendations, skinType, troubleLevel, hasAcne) {
      document.getElementById('skin-analysis').style.display = 'none';
      document.getElementById('cosmetics-recommendation').style.display = 'block';
      
      // ì„œë¸Œíƒ€ì´í‹€ ì„¤ì •
      const subtitle = document.getElementById('recommendation-subtitle');
      const skinTypeText = getSkinTypeText(skinType);
      const troubleText = getTroubleText(troubleLevel);
      const acneText = hasAcne ? ' (í™”ë†ì„± ì—¬ë“œë¦„ ê³ ë ¤)' : '';
      
      subtitle.textContent = `${skinTypeText} Â· ${troubleText}${acneText}ì— ë§ëŠ” ì œí’ˆì„ ì¶”ì²œí•´ë“œë¦½ë‹ˆë‹¤.`;
      
      // ì¶”ì²œ ì œí’ˆ í‘œì‹œ
      const grid = document.getElementById('cosmetics-grid');
      grid.innerHTML = '';
      
      Object.entries(recommendations).forEach(([category, product]) => {
        const categoryText = getCategoryText(category);
        const item = createCosmeticItem(categoryText, product);
        grid.appendChild(item);
      });
    }

    function createCosmeticItem(category, product) {
      const item = document.createElement('div');
      item.className = 'cosmetic-item';
      
      item.innerHTML = `
        <div class="cosmetic-category">${category}</div>
        <div class="cosmetic-product">
          <div class="product-name">${product.name}</div>
          <div class="product-desc">${product.desc}</div>
          <div class="product-links">
            <a href="${product.coupang}" target="_blank" class="product-link coupang">ì¿ íŒ¡ì—ì„œ ë³´ê¸°</a>
            <a href="${product.oliveyoung}" target="_blank" class="product-link oliveyoung">ì˜¬ë¦¬ë¸Œì˜ì—ì„œ ë³´ê¸°</a>
          </div>
        </div>
      `;
      
      return item;
    }

    function getSkinTypeText(skinType) {
      const types = {
        'dry': 'ê±´ì„± í”¼ë¶€',
        'oily': 'ì§€ì„± í”¼ë¶€',
        'combination': 'ë³µí•©ì„± í”¼ë¶€',
        'sensitive': 'ë¯¼ê°ì„± í”¼ë¶€'
      };
      return types[skinType] || 'ì¼ë°˜ í”¼ë¶€';
    }

    function getTroubleText(troubleLevel) {
      const troubles = {
        'none': 'íŠ¸ëŸ¬ë¸” ì—†ìŒ',
        'light': 'ê°€ë²¼ìš´ íŠ¸ëŸ¬ë¸”',
        'moderate': 'ë³´í†µ íŠ¸ëŸ¬ë¸”',
        'severe': 'ì‹¬í•œ íŠ¸ëŸ¬ë¸”'
      };
      return troubles[troubleLevel] || 'ì¼ë°˜';
    }

    function getCategoryText(category) {
      const categories = {
        'cleanser': 'í´ë Œì €',
        'toner': 'í† ë„ˆ',
        'serum': 'ì„¸ëŸ¼',
        'treatment': 'íŠ¸ë¦¬íŠ¸ë¨¼íŠ¸',
        'moisturizer': 'ëª¨ì´ìŠ¤ì¶°ë¼ì´ì €',
        'sunscreen': 'ì„ í¬ë¦¼',
        'spot_treatment': 'ìŠ¤íŒŸ íŠ¸ë¦¬íŠ¸ë¨¼íŠ¸'
      };
      return categories[category] || category;
    }

    function showBasicRecommendation(skinType) {
      // ê¸°ë³¸ ì¶”ì²œ ë¡œì§
      const basicRecommendations = {
        cleanser: {
          name: "ìˆœí•œ í´ë Œì €",
          desc: "í”¼ë¶€ íƒ€ì…ì— ë§ëŠ” ê¸°ë³¸ í´ë Œì§•",
          coupang: "https://www.coupang.com/",
          oliveyoung: "https://www.oliveyoung.co.kr/"
        },
        moisturizer: {
          name: "ë³´ìŠµ í¬ë¦¼",
          desc: "ê¸°ë³¸ì ì¸ ë³´ìŠµ ì¼€ì–´",
          coupang: "https://www.coupang.com/",
          oliveyoung: "https://www.oliveyoung.co.kr/"
        }
      };
      
      showCosmeticsRecommendation(basicRecommendations, skinType, 'none', false);
    }

    // ê°ì • ì¸ì‹ ê´€ë ¨ í•¨ìˆ˜ë“¤
    async function initEmotionDetection() {
      try {
        document.getElementById('status').textContent = 'ëª¨ë¸ì„ ë¡œë”©ì¤‘ì…ë‹ˆë‹¤...';
        
        // ì—¬ê¸°ì— ì‹¤ì œ ê°ì • ì¸ì‹ ëª¨ë¸ ë¡œë”© ì½”ë“œë¥¼ ì¶”ê°€
        // ì˜ˆì‹œ: const modelURL = 'your-model-url';
        // model = await tmImage.load(modelURL, metadataURL);
        
        document.getElementById('status').textContent = 'ì›¹ìº ì„ ì´ˆê¸°í™”ì¤‘ì…ë‹ˆë‹¤...';
        await setupWebcam();
        
        document.getElementById('status').textContent = 'ì¤€ë¹„ ì™„ë£Œ! ë¶„ì„ì„ ì‹œì‘í•˜ì„¸ìš”.';
        document.getElementById('startBtn').disabled = false;
        
      } catch (error) {
        console.error('ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
        document.getElementById('status').innerHTML = '<span class="error">ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨ í•´ì£¼ì„¸ìš”.</span>';
      }
    }

    async function setupWebcam() {
      const flip = true;
      webcam = new tmImage.Webcam(320, 240, flip);
      await webcam.setup();
      
      document.getElementById('webcam-container').appendChild(webcam.canvas);
    }

    async function startDetection() {
      if (!webcam) return;
      
      isDetecting = true;
      document.getElementById('startBtn').style.display = 'none';
      document.getElementById('restartBtn').style.display = 'inline-block';
      document.getElementById('predictions').style.display = 'block';
      
      await webcam.play();
      document.getElementById('status').innerHTML = '<span class="success">ì‹¤ì‹œê°„ ê°ì • ë¶„ì„ ì¤‘...</span>';
      
      // ì‹¤ì œ ì˜ˆì¸¡ ë£¨í”„ ì‹œì‘
      requestAnimationFrame(predict);
    }

    async function predict() {
      if (!isDetecting) return;
      
      webcam.update();
      
      // ì—¬ê¸°ì— ì‹¤ì œ ì˜ˆì¸¡ ì½”ë“œ ì¶”ê°€
      // const prediction = await model.predict(webcam.canvas);
      // updatePredictions(prediction);
      
      // ë°ëª¨ìš© ê°€ì§œ ì˜ˆì¸¡ ê²°ê³¼
      updateDemoPredictions();
      
      requestAnimationFrame(predict);
    }

    function updateDemoPredictions() {
      const demoEmotions = ['Happy', 'Sad', 'Angry', 'Surprised', 'Neutral'];
      const predictionList = document.getElementById('prediction-list');
      predictionList.innerHTML = '';
      
      demoEmotions.forEach(emotion => {
        const confidence = Math.random();
        const item = document.createElement('div');
        item.className = 'prediction-item';
        item.innerHTML = `
          <span>${emotion}</span>
          <div class="prediction-bar">
            <div class="prediction-fill" style="width: ${confidence * 100}%"></div>
          </div>
          <span>${(confidence * 100).toFixed(1)}%</span>
        `;
        predictionList.appendChild(item);
      });
    }

    function restart() {
      isDetecting = false;
      document.getElementById('startBtn').style.display = 'inline-block';
      document.getElementById('restartBtn').style.display = 'none';
      document.getElementById('predictions').style.display = 'none';
      document.getElementById('music-recommendation').style.display = 'none';
      document.getElementById('status').textContent = 'ì¤€ë¹„ ì™„ë£Œ! ë¶„ì„ì„ ì‹œì‘í•˜ì„¸ìš”.';
      
      if (webcam) {
        webcam.stop();
      }
    }

    function stopWebcam() {
      isDetecting = false;
      if (webcam) {
        webcam.stop();
        const container = document.getElementById('webcam-container');
        if (container.firstChild) {
          container.removeChild(container.firstChild);
        }
      }
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
    window.addEventListener('load', () => {
      // PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ í‘œì‹œ (ì§€ì—°)
      setTimeout(() => {
        if (!window.matchMedia('(display-mode: standalone)').matches) {
          showInstallPrompt();
        }
      }, 3000);
    });
  </script>
</body>
</html>
